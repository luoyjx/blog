---
slug: 5486ba8be5cd3c2f35320ec0
title: nodejs中的模块加载机制笔记
tags: [node.js]
---

 &nbsp;&nbsp;&nbsp;&nbsp;由于嫌项目中用到的global对象不太好，所以想将全局变量封装到自定义的global模块中，记得模块是有闭包特性的。 

&nbsp; &nbsp; 但是我的疑问是，比如我的global变量是一个变的，我在某个js中引入模块，那么我在另一个地方引入是不是重新初始化了呢。 

&nbsp; &nbsp; InfoQ和博客园找到了些答案，记下笔记。 

&nbsp;&nbsp;&nbsp;&nbsp; 

### &nbsp;&nbsp;&nbsp;&nbsp;模块载入策略 

&nbsp;&nbsp;&nbsp;&nbsp;Node.js的模块分为两类，一类为原生（核心）模块，一类为文件模块。原生模块在Node.js源代码编译的时候编译进了二进制执行文件，加载的速度最快。另一类文件模块是动态加载的，加载速度比原生模块慢。但是Node.js对原生模块和文件模块都进行了缓存，于是在第二次require时，是不会有重复开销的。其中原生模块都被定义在lib这个目录下面，文件模块则不定性。 

&nbsp; &nbsp; 原文地址：http://www.infoq.com/cn/articles/nodejs-module-mechanism/ 

&nbsp;&nbsp;&nbsp;&nbsp; 

&nbsp;&nbsp;&nbsp;&nbsp;在《深入浅出nodejs》有这样一段（有部分增减）：  
  
&nbsp;&nbsp;&nbsp;&nbsp;1、nodejs引入模块分四个步骤  
  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;路径分析  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;文件定位  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;编译执行  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;加入内存  
&nbsp;&nbsp;&nbsp;&nbsp;2、核心模块部分在node源代码的编译过程中就编译成了二级制文件，在node启动时就直接加载如内存，所以这部分模块引入时，前三步省略，直接加入。  
  
&nbsp;&nbsp;&nbsp;&nbsp;3、nodejs的模块加载和浏览器js加载一样都有缓存机制，不同的是，浏览器仅仅缓存文件，而nodejs缓存的是编译和执行后的对象（缓存内存）。 

&nbsp; &nbsp; 原文地址：http://www.cnblogs.com/tyhmj/p/3799039.html 

&nbsp; &nbsp; 等测试后再发表评论~ 


