---
slug: 55f50bc3002653cf0837d78a
title: 【开发日志】添加评论及at的邮件提醒功能
tags: [开发日志 ,nodemailer]
---

之前添加了评论at功能，确实方便多了，如果有回复可以看到提醒。

但是，随之而来发现一个问题，就是我在离开站点之后，并不能及时的知道我收到的回复。

于是就有了现在这个邮件提醒功能。

> 思路：
每次访问时，如果是已登录用户，则加入缓存，30分钟失效，30分钟内未访问表示离线。
在收到评论或文章at时，去查询这个用户在缓存中是否存在，不存在则发送邮件提醒。

缓存就使用redis了，mail依旧是nodemailer

下面，开始测试测试：
只at了大概最近注册的10位小伙伴

@doramart @didyqian @testuser @zoro_1943 @alimi @lovefishs @xeecos @xeecos @daimonhunter @lpckkx @xushuangshuang


代码更新在这里：
https://github.com/luoyjx/gaoqi-blog/commit/3a2e9b5c756ddaa6bb365cbfc6c81600454e655d

---

出了点小问题，更新的时候有bug，已修复
